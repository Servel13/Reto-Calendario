<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Reto en Pareja ğŸ’™ğŸ’–</title>

  <!-- Firebase SDK (compatibilidad con navegadores sin mÃ³dulos) -->
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>

  <style>
    
    /* MODO OSCURO */
body.dark {
  background: #121212;
  color: #f5f5f5;
}

body.dark .day {
  background: #1e1e1e;
  border-color: #444;
  box-shadow: 0 0 5px #000;
}

body.dark .counters {
  background: #1e1e1e;
  color: #fff;
  box-shadow: 0 0 8px #000;
}

body.dark .month-nav button {
  background: #222;
  color: #fff;
}

body.dark #toggleDark {
  background: #eee !important;
  color: #000 !important;
}
    
    body {
      font-family: 'Poppins', sans-serif;
      background: #fafafa;
      text-align: center;
      margin: 0;
      padding: 0;
    }
    h1 {
      margin-top: 20px;
    }
    .month-nav {
      margin: 10px 0;
    }
    .month-nav button {
      padding: 8px 14px;
      margin: 0 5px;
      border: none;
      border-radius: 10px;
      background: #444;
      color: #fff;
      font-size: 16px;
      cursor: pointer;
    }
    .calendar {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      max-width: 900px;
      margin: 20px auto;
      gap: 8px;
    }
    .day {
  border: 1px solid #ccc;
  border-radius: 14px;
  padding: 10px 6px;
  background: white;
  min-height: 110px;
  box-shadow: 0 4px 10px rgba(0,0,0,0.08);

  display: flex;
  flex-direction: column;
  justify-content: space-between;
}
    .day-number {
  font-size: 12px;
  color: #999;
  text-align: right;
  padding-right: 6px;
}
    .icons {
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 10px;
  font-size: 22px;
  margin: 6px 0;
  flex-wrap: wrap;
}
    .row-label {
  font-size: 11px;
  color: #aaa;
  margin-top: 4px;
}
    .icons span {
  cursor: pointer;
  transition: transform 0.15s ease, box-shadow 0.2s ease;
  border-radius: 50%;
  padding: 5px;
}
    .icons span:hover {
  transform: scale(1.25);
}
    .active-blue {
  background-color: rgba(0, 120, 255, 0.25);
  box-shadow: 0 0 10px rgba(0, 120, 255, 0.7);
}
    
.active-pink {
  background-color: rgba(255, 20, 147, 0.25);
  box-shadow: 0 0 10px rgba(255, 20, 147, 0.7);
}
    .active-soda {
  background-color: rgba(255, 60, 60, 0.3);
  box-shadow: 0 0 10px rgba(255, 60, 60, 0.7);
}
    .counters {
      margin: 20px auto;
      max-width: 600px;
      background: white;
      padding: 15px;
      border-radius: 15px;
      box-shadow: 0 0 10px #ccc;
    }
    .counters div {
      margin: 5px 0;
      font-size: 16px;
    }

    /* ğŸ“± VISTA MÃ“VIL */
@media (max-width: 600px) {

  h1 {
    font-size: 20px;
    margin: 12px 0;
  }

  .month-nav {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 10px;
  }

  .month-nav button {
    padding: 6px 10px;
    font-size: 14px;
  }

  .calendar {
    grid-template-columns: repeat(2, 1fr);
    gap: 10px;
    padding: 0 10px;
  }

  .day {
    min-height: 140px;
    padding: 10px 6px;
  }

  .day-number {
    font-size: 13px;
  }

  .row-label {
    font-size: 10px;
    margin-top: 6px;
  }

  .icons {
    font-size: 24px;
    gap: 12px;
    margin: 8px 0;
  }

  .icons span {
    padding: 6px;
  }

  .counters {
    font-size: 14px;
    margin: 15px 10px;
  }

}
  </style>
</head>
<body>

  <button id="toggleDark" style="
  position: fixed; 
  top: 10px; 
  right: 10px; 
  padding: 8px 12px; 
  border-radius: 10px;
  border: none;
  background: #333;
  color: white;
  cursor: pointer;
">
ğŸŒ™
</button>
  
  <h1>ğŸ’ª Reto en Pareja â€” Enero / Febrero</h1>

  <div class="month-nav">
    <button id="prev">â¬…ï¸</button>
    <span id="monthName" style="font-weight:bold; font-size:18px;"></span>
    <button id="next">â¡ï¸</button>
  </div>

  <div id="calendar" class="calendar"></div>

  <div class="counters">
    <div>ğŸ’™ <b>Servel</b> â€” ğŸƒâ€â™‚ï¸ <span id="b-ex">0</span> | ğŸ½ï¸ <span id="b-food">0</span> | ğŸ’§ <span id="b-water">0</span> | ğŸ¥¤ <span id="b-soda">0</span></div> 
    <div>ğŸ’– <b>Carmen</b> â€” ğŸƒâ€â™€ï¸ <span id="g-ex">0</span> | ğŸ½ï¸ <span id="g-food">0</span> | ğŸ’§ <span id="g-water">0</span> | ğŸ¥¤ <span id="g-soda">0</span></div>
  </div>

  <script>
    // Inicializar Firebase
    const firebaseConfig = {
      apiKey: "AIzaSyAuq6Dm4P989aa_63PFcCYHPVpsF7gnpiA",
      authDomain: "reto-calendario.firebaseapp.com",
      projectId: "reto-calendario",
      storageBucket: "reto-calendario.appspot.com",
      messagingSenderId: "1012712540953",
      appId: "1:1012712540953:web:c329e1b5f002a6a7e2d388",
      measurementId: "G-928B2T1JRG"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    const months = [
      { name: "Enero", days: 31 },
      { name: "Febrero", days: 28 }
      //{ name: "Diciembre", days: 31 }
    ];
    let currentMonth = 0;

    const calendar = document.getElementById("calendar");
    const monthName = document.getElementById("monthName");

    function renderCalendar() {
      monthName.textContent = months[currentMonth].name;
      calendar.innerHTML = "";

      for (let d = 1; d <= months[currentMonth].days; d++) {
        const div = document.createElement("div");
        div.className = "day";
        div.innerHTML = `
          <div class="day-number">${d}</div>
          <div class="row-label">ğŸ’™ Servel</div>
          <div class="icons" data-person="b" data-day="${d}">
            <span data-type="exercise">ğŸƒâ€â™‚ï¸</span>
            <span data-type="food">ğŸ½ï¸</span>
            <span data-type="water">ğŸ’§</span>
            <span data-type="soda">ğŸ¥¤</span>
          </div>
          <div class="row-label">ğŸ’– Carmen</div>
          <div class="icons" data-person="g" data-day="${d}">
            <span data-type="exercise">ğŸƒâ€â™€ï¸</span>
            <span data-type="food">ğŸ½ï¸</span>
            <span data-type="water">ğŸ’§</span>
            <span data-type="soda">ğŸ¥¤</span>
          </div>
        `;
        calendar.appendChild(div);
      }

      loadProgress();
      addClickHandlers();
    }

    function addClickHandlers() {
      calendar.querySelectorAll(".icons span").forEach((icon) => {
        icon.addEventListener("click", async () => {
          const parent = icon.parentElement;
          const person = parent.dataset.person;
          const day = parent.dataset.day;
          const type = icon.dataset.type;
          const colorClass = person === "b" ? "active-blue" : "active-pink";
          const path = `users/${months[currentMonth].name}/${person}/days/${day}/${type}`;
          const refPath = db.ref(path);

          const snapshot = await refPath.get();
          const isActive = snapshot.exists() && snapshot.val().active;

          if (isActive) {
            icon.classList.remove(colorClass);
            refPath.remove();
          } else {
            icon.classList.add(colorClass);
            refPath.set({ active: true });
          }

          updateCounters();
        });
      });
    }

    function loadProgress() {
      calendar.querySelectorAll(".icons span").forEach(async (icon) => {
        const parent = icon.parentElement;
        const person = parent.dataset.person;
        const day = parent.dataset.day;
        const type = icon.dataset.type;
        const colorClass = person === "b" ? "active-blue" : "active-pink";
        const path = `users/${months[currentMonth].name}/${person}/days/${day}/${type}`;
        const refPath = db.ref(path);

        const snapshot = await refPath.get();
        if (snapshot.exists() && snapshot.val().active) {
          icon.classList.add(colorClass);
        }
      });

      updateCounters();
    }

    async function updateCounters() {
  const counters = {
    b: { exercise: 0, food: 0, water: 0, soda: 0 },
    g: { exercise: 0, food: 0, water: 0, soda: 0 },
  };

  for (const person of ["b", "g"]) {
    const refPath = db.ref(`users/${months[currentMonth].name}/${person}/days`);
    const snapshot = await refPath.get();
    if (snapshot.exists()) {
      snapshot.forEach((daySnap) => {
        daySnap.forEach((typeSnap) => {
          if (typeSnap.val().active) {
            counters[person][typeSnap.key]++;
          }
        });
      });
    }
  }

  // Actualiza contadores en pantalla
  document.getElementById("b-ex").textContent = counters.b.exercise;
  document.getElementById("b-food").textContent = counters.b.food;
  document.getElementById("b-water").textContent = counters.b.water;
  document.getElementById("b-soda").textContent = counters.b.soda;
  document.getElementById("g-ex").textContent = counters.g.exercise;
  document.getElementById("g-food").textContent = counters.g.food;
  document.getElementById("g-water").textContent = counters.g.water;
  document.getElementById("g-soda").textContent = counters.g.soda;

  // Mostrar mensajes especiales solo una vez usando localStorage
  const prevCountsKey = `prevCounts-${months[currentMonth].name}`;
  const prevCounts = JSON.parse(localStorage.getItem(prevCountsKey)) || { g: { food: 0, water: 0, exercise: 0, soda: 0 } };

// Mensajes cuando sube a 15
//if (counters.g.water >= 15 && prevCounts.g.water < 15) {
  //alert("ğŸ’§ Ya eres 70% agua y 100% mi debilidad");
//}
//if (counters.g.food >= 15 && prevCounts.g.food < 15) {
  //alert("ğŸ½ï¸ No solo estÃ¡s comiendo mejor, estÃ¡s siendo tu mejor versiÃ³n");
//}
//if (counters.g.exercise >= 15 && prevCounts.g.exercise < 15) {
 // alert("ğŸƒâ€â™€ï¸ Sigue dÃ¡ndole, que tu esfuerzo te hace brillar, y a mÃ­ me encanta verte asÃ­.");
//}

// Guardar los valores actuales como referencia
//localStorage.setItem(prevCountsKey, JSON.stringify(counters));
    }

    document.getElementById("prev").addEventListener("click", () => {
      if (currentMonth > 0) currentMonth--;
      renderCalendar();
    });

    document.getElementById("next").addEventListener("click", () => {
      if (currentMonth < months.length - 1) currentMonth++;
      renderCalendar();
    });

    // MODO OSCURO
const toggleBtn = document.getElementById("toggleDark");

// Cargar preferencia
if (localStorage.getItem("darkMode") === "true") {
  document.body.classList.add("dark");
  toggleBtn.textContent = "â˜€ï¸";
}

toggleBtn.addEventListener("click", () => {
  document.body.classList.toggle("dark");

  const isDark = document.body.classList.contains("dark");
  toggleBtn.textContent = isDark ? "â˜€ï¸" : "ğŸŒ™";

  localStorage.setItem("darkMode", isDark);
});
    
    renderCalendar();    
  </script>
</body>
</html>




















