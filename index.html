<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Reto en Pareja ğŸ’™ğŸ’–</title>
<style>
  body {
    font-family: 'Poppins', sans-serif;
    background: #fafafa;
    text-align: center;
    margin: 0;
    padding: 0;
  }
  h1 {
    margin-top: 20px;
  }
  .month-nav {
    margin: 10px 0;
  }
  .month-nav button {
    padding: 8px 14px;
    margin: 0 5px;
    border: none;
    border-radius: 10px;
    background: #444;
    color: #fff;
    font-size: 16px;
    cursor: pointer;
  }
  .calendar {
    display: grid;
    grid-template-columns: repeat(7, 1fr);
    max-width: 900px;
    margin: 20px auto;
    gap: 8px;
  }
  .day {
    border: 1px solid #ccc;
    border-radius: 12px;
    padding: 6px;
    background: white;
    min-height: 90px;
    box-shadow: 0 0 5px #ddd;
  }
  .day-number {
    font-size: 12px;
    color: #666;
    margin-bottom: 2px;
  }
  .icons {
    display: flex;
    justify-content: center;
    gap: 6px;
    font-size: 22px;
    margin-top: 4px;
  }
  .row-label {
    font-size: 10px;
    color: #888;
  }
  .icons span {
    cursor: pointer;
    transition: transform 0.2s, background-color 0.3s;
    border-radius: 50%;
    padding: 4px;
  }
  .icons span:hover {
    transform: scale(1.2);
  }
  /* ğŸ’™ Benito (azul activo) */
  .active-blue {
    background-color: rgba(0, 100, 255, 0.25);
    box-shadow: 0 0 6px rgba(0, 100, 255, 0.5);
  }
  /* ğŸ’– Ella (rosa activo) */
  .active-pink {
    background-color: rgba(255, 20, 147, 0.25);
    box-shadow: 0 0 6px rgba(255, 20, 147, 0.5);
  }
  .counters {
    margin: 20px auto;
    max-width: 600px;
    background: white;
    padding: 15px;
    border-radius: 15px;
    box-shadow: 0 0 10px #ccc;
  }
  .counters div {
    margin: 5px 0;
    font-size: 16px;
  }
</style>
</head>
<body>

<h1>ğŸ’ª Reto en Pareja â€” Octubre / Noviembre / Diciembre</h1>

<div class="month-nav">
  <button id="prev">â¬…ï¸</button>
  <span id="monthName" style="font-weight:bold; font-size:18px;"></span>
  <button id="next">â¡ï¸</button>
</div>

<div id="calendar" class="calendar"></div>

<div class="counters">
  <div>ğŸ’™ <b>Servel</b> â€” ğŸƒâ€â™‚ï¸ <span id="b-ex">0</span> | ğŸ½ï¸ <span id="b-food">0</span> | ğŸ’§ <span id="b-water">0</span></div>
  <div>ğŸ’– <b>Carmen</b> â€” ğŸƒâ€â™€ï¸ <span id="g-ex">0</span> | ğŸ½ï¸ <span id="g-food">0</span> | ğŸ’§ <span id="g-water">0</span></div>
</div>

<script>
const months = [
  { name: "Octubre", days: 31 },
  { name: "Noviembre", days: 30 },
  { name: "Diciembre", days: 31 }
];
let currentMonth = 0;

const calendar = document.getElementById('calendar');
const monthName = document.getElementById('monthName');

function renderCalendar() {
  monthName.textContent = months[currentMonth].name;
  calendar.innerHTML = '';
  for (let d = 1; d <= months[currentMonth].days; d++) {
    const div = document.createElement('div');
    div.className = 'day';
    div.innerHTML = `
      <div class="day-number">${d}</div>
      <div class="row-label">ğŸ’™ Servel</div>
      <div class="icons" data-person="b" data-day="${d}">
        <span data-type="exercise">ğŸƒâ€â™‚ï¸</span>
        <span data-type="food">ğŸ½ï¸</span>
        <span data-type="water">ğŸ’§</span>
      </div>
      <div class="row-label">ğŸ’– Carmen</div>
      <div class="icons" data-person="g" data-day="${d}">
        <span data-type="exercise">ğŸƒâ€â™€ï¸</span>
        <span data-type="food">ğŸ½ï¸</span>
        <span data-type="water">ğŸ’§</span>
      </div>`;
    calendar.appendChild(div);
  }
  loadProgress();
  addClickHandlers();
}

function addClickHandlers() {
  calendar.querySelectorAll('.icons span').forEach(icon => {
    icon.addEventListener('click', () => {
      const parent = icon.parentElement;
      const person = parent.dataset.person;
      const day = parent.dataset.day;
      const type = icon.dataset.type;
      const key = `${months[currentMonth].name}-${day}-${person}-${type}`;
      let data = JSON.parse(localStorage.getItem(key)) || {};
      const isActive = data.active || false;
      const colorClass = person === 'b' ? 'active-blue' : 'active-pink';

      // toggle
      if (isActive) {
        icon.classList.remove(colorClass);
        localStorage.removeItem(key);
      } else {
        icon.classList.add(colorClass);
        localStorage.setItem(key, JSON.stringify({ active: true, person }));
      }
      updateCounters();
    });
  });
}

function updateCounters() {
  const allKeys = Object.keys(localStorage);
  const counters = {
    b: { exercise:0, food:0, water:0 },
    g: { exercise:0, food:0, water:0 }
  };
  allKeys.forEach(k => {
    const v = JSON.parse(localStorage.getItem(k));
    if (!v) return;
    const parts = k.split('-');
    const type = parts[3];
    const person = parts[2];
    counters[person][type]++;
  });
  document.getElementById('b-ex').textContent = counters.b.exercise;
  document.getElementById('b-food').textContent = counters.b.food;
  document.getElementById('b-water').textContent = counters.b.water;
  document.getElementById('g-ex').textContent = counters.g.exercise;
  document.getElementById('g-food').textContent = counters.g.food;
  document.getElementById('g-water').textContent = counters.g.water;
}

function loadProgress() {
  calendar.querySelectorAll('.icons span').forEach(icon => {
    const parent = icon.parentElement;
    const person = parent.dataset.person;
    const day = parent.dataset.day;
    const type = icon.dataset.type;
    const key = `${months[currentMonth].name}-${day}-${person}-${type}`;
    const data = JSON.parse(localStorage.getItem(key));
    const colorClass = person === 'b' ? 'active-blue' : 'active-pink';
    if (data && data.active) icon.classList.add(colorClass);
  });
  updateCounters();
}

document.getElementById('prev').addEventListener('click', () => {
  if (currentMonth > 0) currentMonth--;
  renderCalendar();
});
document.getElementById('next').addEventListener('click', () => {
  if (currentMonth < months.length - 1) currentMonth++;
  renderCalendar();
});

renderCalendar();
</script>

  <!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Reto en Pareja ğŸ’™ğŸ’–</title>
  <style>
    body {
      font-family: Arial;
      background: #fafafa;
      text-align: center;
      margin: 0;
      padding: 20px;
    }
    h1 { margin-bottom: 10px; }
    #calendar {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 10px;
      justify-items: center;
    }
    .day {
      width: 80px;
      height: 80px;
      background: white;
      border-radius: 10px;
      box-shadow: 0 0 5px rgba(0,0,0,0.1);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: 0.2s;
    }
    .day:hover { transform: scale(1.05); }
    .icons {
      display: flex;
      gap: 3px;
      font-size: 24px;
    }
    .clicked-blue { filter: drop-shadow(0 0 4px #00f); }
    .clicked-pink { filter: drop-shadow(0 0 4px #f0c); }
    #controls { margin-bottom: 15px; }
    button {
      margin: 5px;
      padding: 5px 10px;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <h1>Reto en Pareja ğŸ’™ğŸ’–</h1>
  <div id="controls">
    <button onclick="changeUser('blue')">ğŸ’™ Benito</button>
    <button onclick="changeUser('pink')">ğŸ’– Ella</button>
  </div>
  <div id="calendar"></div>

  <!-- Firebase -->
  <script type="module">
    // Importar SDK
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.13.2/firebase-app.js";
    import { getDatabase, ref, set, onValue } from "https://www.gstatic.com/firebasejs/10.13.2/firebase-database.js";

    // ğŸ”§ CONFIGURACIÃ“N (reemplÃ¡zala con la tuya)
    const firebaseConfig = {
        apiKey: "AIzaSyAuq6Dm4P989aa_63PFcCYHPVpsF7gnpiA",
        authDomain: "reto-calendario.firebaseapp.com",
        projectId: "reto-calendario",
        storageBucket: "reto-calendario.firebasestorage.app",
        messagingSenderId: "1012712540953",
        appId: "1:1012712540953:web:c329e1b5f002a6a7e2d388",
        measurementId: "G-928B2T1JRG"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);

    const calendar = document.getElementById("calendar");
    let currentUser = "blue"; // por defecto

    const emojis = ["ğŸƒâ€â™‚ï¸","ğŸ½ï¸","ğŸ’§"];

    // Crear calendario (ejemplo: 31 dÃ­as)
    for (let i = 1; i <= 31; i++) {
      const dayDiv = document.createElement("div");
      dayDiv.className = "day";
      dayDiv.innerHTML = `
        <div class="icons" id="icons-${i}">
          ${emojis.map((e, idx) => `
            <span id="d${i}-${idx}-b">${e}</span>
            <span id="d${i}-${idx}-p">${e}</span>
          `).join("")}
        </div>
        <small>${i}</small>
      `;
      calendar.appendChild(dayDiv);
    }

    // Escuchar cambios en la base de datos
    const dataRef = ref(db, "reto");
    onValue(dataRef, snapshot => {
      const data = snapshot.val() || {};
      document.querySelectorAll("span").forEach(span => {
        span.classList.remove("clicked-blue","clicked-pink");
      });
      for (const key in data) {
        if (data[key] === "blue") document.getElementById(key)?.classList.add("clicked-blue");
        if (data[key] === "pink") document.getElementById(key)?.classList.add("clicked-pink");
      }
    });

    // Manejar clics
    document.querySelectorAll("span").forEach(span => {
      span.addEventListener("click", () => {
        set(ref(db, "reto/" + span.id), currentUser);
      });
    });

    function changeUser(user) {
      currentUser = user;
      alert(`Ahora estÃ¡s marcando como ${user === "blue" ? "ğŸ’™ Benito" : "ğŸ’– Ella"}`);
    }
  </script>
</body>
</html>


</body>

</html>

